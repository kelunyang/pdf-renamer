# PDF重命名工具

一個用於批量處理PDF文件的工具，可以根據文件內容、metadata自動重命名PDF文件，並支援加密功能。
最少是用 C# 寫的，2025年改用python重寫，開發環境換到Trae，搭配AI開發工具重構。

## 開發紀錄

2023 C#原始版本： 讀取更名原則CSV，依據metadata、內容重新命名PDF，並支援加密
2024 C#修正版本： 更換PDF讀取模組，主因是原本用的模組實在太容易讀出亂碼了
2025 python版本： 重構，加入paddleOCR，支援圖形PDF的OCR功能，並使用sqlite記錄處理狀態，不知道為什麼python效率似乎比C#稍弱，所以又多了一個多線程的能力

## 功能特點

- **依據原則重命名**：根據PDF內容或metadata自動重命名
- **批量處理**：支持同時處理多個PDF文件
- **PDF切割**：將大型PDF文件切割成多個小文件
- **PDF加密**：為重命名後的文件添加密碼保護
- **OCR支援**：可選使用PaddleOCR進行文字識別（需額外安裝）
- **多線程處理**：利用多核心CPU加速處理
- **數據庫支持**：使用SQLite記錄處理狀態和結果
- **詳細日誌**：記錄所有操作和錯誤信息

## 安裝需求

### 基本需求

- Python 3.7+
- PyPDF2：PDF基本操作
- PyMuPDF (fitz)：高效PDF文本提取
- pikepdf：PDF加密和處理
- paddleocr & paddlepaddle：OCR識別（可選）
- questionary：增強的命令行交互
- tqdm：進度顯示

*放心，會自動安裝*

## 使用方法

### 基本使用

```bash
python main.py  # 使用python版本
```

### 功能流程

1. [可跳過]**PDF切割**：
   - 輸入要切割的PDF檔案路徑
   - 指定輸出目錄
   - 設定每個檔案的頁數

2. **設定搜尋規則**：
   - 輸入關鍵字或正則表達式
   - 設定目標檔名
   - 選擇搜尋目標（內容或metadata）
   - 設定匹配次數
   - 選擇是否加密及設定密碼

3. **處理結果**：
   - 程式會自動處理所有符合條件的PDF檔案
   - 生成處理日誌

## python模塊說明

以下是本項目中使用的所有Python文件及其功能：

- **main.py**：主程序入口，包含用戶界面和主要流程控制
- **db_utils.py**：數據庫工具，負責管理SQLite數據庫連接和操作，確保線程安全
- **log_utils.py**：日誌工具，負責記錄程序運行日誌
- **file_utils.py**：文件操作工具，負責文件重命名、複製等操作
- **pdf_utils.py**：PDF處理工具，負責PDF文件的讀取、內容提取、加密等操作
- **input_utils.py**：輸入處理工具，負責用戶輸入的驗證和處理
- **rule_utils.py**：規則處理工具，負責管理重命名規則
- **build_pyz.py**：打包工具，用於將程式打包成單一的.pyz文件（非常不建議使用打包工具，因為會沒辦法安裝額外的模組）
- **bak**： 跟AI對話過程中生出來的一些無用的py檔案，或者是原本只打算寫一個.py，但是AI幻覺有點嚴重，最後拆解成多個模塊，所以就有了這個目錄
- **build_exe.py**：打包工具，用於將程序打包成單一的.exe文件（建議使用）

## C#版本說明

ㄟ，2025年了，我覺得你還是別再繼續用C#版本了

## 注意事項

- 使用OCR功能需要額外安裝PaddleOCR和PaddlePaddle，OCR不要開太多線程，速度取決於你的硬體
- 打包版本已包含所有必要的Python模塊，但仍需要系統上安裝Python解釋器
- 如果需要OCR功能，建議單獨安裝PaddleOCR，而不是通過打包版本使用

## 授權協議

本項目採用MIT授權協議。（如果我使用到的其他模塊沒有特別要求的話）